create table categoria(
cod_cat int not null primary key,
nome varchar(20) not null,
descr varchar(1000) not null,
valor_dia float not null);

create table apto(
num int not null primary key,
status char(1) not null,
cod_cat int not null references categoria(cod_cat)
);

CREATE TABLE hospede(
cod_hosp int NOT null PRIMARY KEY,
nome varchar(50) NOT null,
dt_nasc date);

create table atendente(
cod_atend int not null primary key,
nome varchar(50) not null,
fone varchar(20) not null,
dt_nasc date
);

create table hospedagem(
cod_hospeda int not null primary key,
cod_hosp int not null references hospede(cod_hosp),
num int not null references apto(num),
cod_atend int not null references atendente(cod_atend),
dt_ent date not null,
dt_sai date
);
INSERT INTO CATEGORIA VALUES(1,'BASICO','APARTAMENTO SIMPLES COM UMA
CAMA DE SOLTEIRO, SEM AR CONDICIONADO',100);
INSERT INTO CATEGORIA VALUES(2,'BASICO COM AR','APARTAMENTO SIMPLES
COM UMA CAMA DE SOLTEIRO, COM AR CONDICIONADO',150);
INSERT INTO CATEGORIA VALUES(3,'DUPLO','APARTAMENTO SIMPLES COM DUAS
CAMAS DE SOLTEIRO, SEM AR CONDICIONADO',200);
INSERT INTO CATEGORIA VALUES(4,'DUPLO COM AR','APARTAMENTO SIMPLES COM
DUAS CAMAS DE SOLTEIRO, COM AR CONDICIONADO',250);
INSERT INTO CATEGORIA VALUES(5,'CASAL','APARTAMENTO SIMPLES COM UMA
CAMA DE CASAL, SEM AR CONDICIONADO',150);
INSERT INTO CATEGORIA VALUES(6,'CASAL COM AR','APARTAMENTO SIMPLES COM
UMA CAMA DE CASAL, COM AR CONDICIONADO',200);
INSERT INTO CATEGORIA VALUES(7,'LUXO SOLTEIRO','APARTAMENTO DE LUXO
COM UMA CAMA DE SOLTEIRO, AR CONDICIONADO, FRIGOBAR',350);
INSERT INTO CATEGORIA VALUES(8,'LUXO SOLTEIRO DUPLO','APARTAMENTO DE
LUXO COM DUAS CAMAS DE SOLTEIRO, AR CONDICIONADO, FRIGOBAR',450);
INSERT INTO CATEGORIA VALUES(9,'LUXO CASAL','APARTAMENTO DE LUXO COM
UMA CAMA DE CASAL AR CONDICIONADO, FRIGOBAR',400);
/*OS VALORES PARA APARTAMENTO OCUPADO É "O" OCUPADO "D" DESOCUPADO*/
INSERT INTO APTO VALUES(101,'D',1);
INSERT INTO APTO VALUES(102,'O',2);
INSERT INTO APTO VALUES(103,'D',3);
INSERT INTO APTO VALUES(104,'D',4);
INSERT INTO APTO VALUES(105,'D',5);
INSERT INTO APTO VALUES(201,'D',6);
INSERT INTO APTO VALUES(202,'O',7);
INSERT INTO APTO VALUES(203,'D',8);
INSERT INTO APTO VALUES(204,'D',9);
/*ATUALIZAR DADOS APTO*/
UPDATE APTO SET STATUS = 'O' WHERE NUM = 102;
/*ATRIBUTOS ATENDENTE: (COD, NOME, FONE, NASCIMENTO)*/
INSERT INTO ATENDENTE VALUES(1,'IAN DELL JUNIOR','(86)99563-3080','2000/05/20');
INSERT INTO ATENDENTE VALUES(2,'CLARICE LEITE DOS
ANJOS','(86)99833-0203','1995/12/18');
INSERT INTO ATENDENTE VALUES(3,'IRINEIDE DOS
SANTOS','(89)99945-2223','1980/10/05');
/*ATRIBUTOS HOSPEDE: (COD, NOME, NASCIMENTO)*/
INSERT INTO HOSPEDE VALUES(1,'JOSE DOS SANTOS','2000/03/20');
INSERT INTO HOSPEDE VALUES(2,'JADISSON ANTONIO COSTA','2000/09/15');
INSERT INTO HOSPEDE VALUES(3,'PINTO FILHO','1965/09/01');
INSERT INTO HOSPEDE VALUES(4,'AMALIA SOUSA','1998/06/28');
INSERT INTO HOSPEDE VALUES(5,'SABRINA SILVA','1989/02/14');
/*ATRIBUTOS HOSPEDAGEM: (COD,COD_HOSPEDE,NUM APTO,COD ATENDENTE,DT
ENTRADA, DT SAIDA)*/
INSERT INTO HOSPEDAGEM VALUES(1,1,202,2,'2023/08/19','2023/08/25');
INSERT INTO HOSPEDAGEM VALUES(2,2,204,2,'2023/09/21',NULL);
INSERT INTO HOSPEDAGEM VALUES(3,3,102,1,'2023/09/20',NULL);
INSERT INTO HOSPEDAGEM VALUES(4,4,101,2,'2023/08/10','2023/08/14');
INSERT INTO HOSPEDAGEM VALUES(5,5,203,2,'2023/09/19','2023/09/20');

/*CONSULTA DA TABELA*/
SELECT * FROM CATEGORIA;
SELECT * FROM APTO;
SELECT * FROM ATENDENTE;
SELECT * FROM HOSPEDE;
SELECT * FROM HOSPEDAGEM;

/*EXERCÍCIO DE SALA - OBTER:*/
/*A)O NUMERO DOS APTOS QUE SAO DE CATEGORIA COD 2 */
SELECT NUM FROM APTO WHERE COD_CAT = 2;
/*B)O NOME DOS HOSPEDES QUE POSSUEM CÓD MAIOR QUE 3 */
SELECT NOME FROM HOSPEDE WHERE COD_HOSP > 3;
/*C)COD E NOME DAS CATEGORIAS QUE CUSTAM MAIS DE 500 E MENOS DE 2000 */
SELECT COD_CAT, NOME FROM CATEGORIA WHERE VALOR_DIA > 200 AND
VALOR_DIA < 1000;
/*D)COD E TELEFONE DOS ATENDENTES CUJA TERCEIRA LETRA DO NOME É I */
SELECT COD_ATEND, FONE FROM ATENDENTE WHERE NOME ILIKE '__i%';
/*E)TODAS AS INFORMAÇÕES DOS HOSPEDES QUE NASCERAM NO ANO 2000 */
SELECT * FROM HOSPEDE WHERE DT_NASC BETWEEN '2000/01/01' AND
'2000/12/31';
/*F)COD DOS HOSPEDES COM OS RESPECTIVOS NUMEROS DE APARTAMENTOS
OCUPADOS POR ELES.(TODOS) */
SELECT COD_HOSP, NUM FROM HOSPEDAGEM;
/*G)O NÚMERO DOS APARTAMENTOS QUE FORAM OCUPADOS NO DIA 19/08/2023
OU 20/09/2023 OU 21/09/2023 */
SELECT NUM FROM HOSPEDAGEM WHERE DT_ENT = '2023/08/19' OR DT_ENT =
'2023/09/18' OR DT_ENT = '2023/09/20';
/*H)O NOME DOS ATENDENTES DE COD 1 OU 3 OU 4 OU 9 OU 15 OU 33 */
SELECT NOME FROM ATENDENTE WHERE COD_ATEND = 1 OR COD_ATEND = 3 OR
COD_ATEND = 4 OR COD_ATEND = 9 OR COD_ATEND = 15 OR COD_ATEND = 33;
/*SEGUNDA FORMA*/: SELECT NOME FROM ATENDENTE WHERE COD_ATEND
IN(1,3,4,9,15,33);
/*EXERCÍCIOS 27/09*/
/*A) NOME E TELEFONE DOS ATENDENTES QUE HOSPEDARAM OS HOSPEDES DE
CÓDIGO 2 OU 3*/
SELECT NOME, FONE FROM ATENDENTE WHERE COD_ATEND IN (SELECT
COD_ATEND FROM HOSPEDAGEM WHERE COD_HOSP IN (2,3));
/*B)NOME E TELEFONE DOS ATENDENTES QUE HOSPEDARAM OS HÓSPEDES DE
NOME JOÃO OU MARIA*/
/*C)TODAS AS INFORMAÇOES DOS HÓSPEES QUE SE HOSPEDARAM NA DATA X*/
/*D)O NOME DAS CATEGORIAS DOS APARTAMENTOS QUE FORAM OCUPADOS POR
HOSPEDES QUE NASCERAM NO ANO 2000*/
/*E)O NOME DOS HÓSPEDES QUE FORAM ATENDIDOS POR ATENDENTES CUJO
NOME COMEÇA COM A LETRA "A"*/
/*F)DESAFIO: O NOME DOS HÓSPEDES QUE NASCERAM NA DATA X OU QUE SE
HOSPEDARAM NA DATA Y(ENTRADA)*/
SELECT NOME FROM HOSPEDE WHERE((DT_NASC IN('2000/03/20') OR
(COD_HOSP IN(SELECT COD_HOSP FROM HOSPEDAGEM WHERE DT_ENT
IN('2023/09/20')))));
/*G)CÓDIGO DAS HOSPEDAGENS REALIZADAS PELO ATENDENTE JOÃO OU PARA A
HÓSPEDE MARIA*/
SELECT COD_HOSP FROM HOSPEDAGEM WHERE (
(COD_ATEND IN(SELECT COD_ATEND FROM ATENDENTE WHERE NOME ILIKE
'IAN%')) OR
(COD_HOSP IN (SELECT COD_HOSP FROM HOSPEDE WHERE NOME ILIKE
'SABRINA%')));
/*TESTE:*/
SELECT COD_HOSP FROM HOSPEDAGEM WHERE COD_HOSP IN (SELECT
COD_HOSP FROM HOSPEDE WHERE NOME ILIKE ('SABRINA%'))
/*TAREFA:
*OBTER NOME DOS HOSPEDES QUE SE HOSPEDARAM NOS APTOS DE COD CAT 2
OU FORAM ATENDIDOS PELO ATENDENTE DE NOME JOÃO
*NOME DOS ATENDENTES QUE ATENDERAM A MARIA NO MES DE SETEMBRO DE
2023*/
SELECT NOME FROM HOSPEDE WHERE
/*FUNÇOES AGREGADAS>>>>>
*MAX() = OBTEM O MAIOR VALOR
*MIN() = OBTEM O MENOR VALOR
*SUM() = REALIZA A SOMA
*AVG() = REALIZA A MEDIA
*COUNT() = REALIZA A CONTAGEM
*APARECEM NORMALMENTE ENTRE O SELECT E O FROM*/
--OBTER MAIOR VALOR DO CÓDIGO DE FUNCIONARIO
SELECT MAX(COD_ATEND) FROM ATENDENTE;
--OBTER MENOR NÚMERO DE APARTAMENTO
SELECT MIN(NUM) FROM APTO;
/* ADICIONAR COLUNAS SEM PRECISAR RECRIAR A TABELA:
EXEMPLO:
ALTER TABLE HOSPEDE ADD COLUNN FONE VARCHAR(14); */
/*QUESTÕES:
OBTER O NOME DO HOSPEDE DE MAIOR CÓDIGO:*/
SELECT NOME FROM HOSPEDE WHERE COD_HOSP IN (SELECT MAX(COD_HOSP)
FROM HOSPEDE);
--OBTER O NUMERO DO APARTAMENTO DA CATEGORIA MAIS CARA:
SELECT AP
/*QUESTOES:
--QUANTIDADE DE HOSPEDAGENS REALIZADAS EM APTOS DA CATEGORIA MAIS
BARATA */
--1)OBTER NOME DOS HOSPEDES ATENDIDOS PELO ATENDENTE MAIS JOVEM:
SELECT NOME FROM HOSPEDE WHERE COD_HOSP IN (SELECT COD_HOSP FROM
HOSPEDAGEM WHERE COD_ATEND IN
(SELECT COD_ATEND FROM ATENDENTE WHERE DT_NASC IN(SELECT
MAX(DT_NASC) FROM ATENDENTE)));
--2)OBTER CODIGO E NOME DO HOSPEDE MAIS JOVEM OU QUEM SE HOSPEDOU
PRIMEIRO
SELECT COD_HOSP, NOME FROM HOSPEDE WHERE DT_NASC IN(SELECT
MAX(DT_NASC) FROM HOSPEDE) OR COD_HOSP IN
(SELECT COD_HOSP FROM HOSPEDAGEM WHERE DT_ENT IN (SELECT
MIN(DT_ENT) FROM HOSPEDAGEM));
--3)QUANTIDADE DE HOSPEDAGENS REALIZADAS NO APTO 5
SELECT COUNT(*) FROM HOSPEDAGEM WHERE NUM IN (202);